<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>blackqwerty</title>
  <subtitle>talk is cheapï¼Œlet me show you the code</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2017-08-14T16:28:34.000Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>guaju</name>
    <email>guaju@126.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>picassoä¸å®Œå…¨è§£æ</title>
    <link href="http://yoursite.com/2017/08/15/picasso%E4%B8%8D%E5%AE%8C%E5%85%A8%E8%A7%A3%E6%9E%90/"/>
    <id>http://yoursite.com/2017/08/15/picassoä¸å®Œå…¨è§£æ/</id>
    <published>2017-08-14T16:20:15.000Z</published>
    <updated>2017-08-14T16:28:34.000Z</updated>
    
    <content type="html"><![CDATA[<p>å¦‚é¢˜ï¼Œä»Šå¤©æˆ‘è¦åšçš„æ˜¯å¯¹picassoè¿›è¡Œä¸å®Œå…¨è§£æï¼Œåˆ‡å…¥ç‚¹å°±é‚£ä¹ˆå‡ ç‚¹ï¼š</p>
<blockquote>
<p>1.å¦‚ä½•åˆå§‹åŒ–<br>2.æ€ä¹ˆåšçš„è”ç½‘è¯·æ±‚<br>3.å¦‚ä½•åšçš„å›¾ç‰‡å‹ç¼©<br>4.å¦‚ä½•åšçš„å†…å­˜ä¸æœ¬åœ°ç¼“å­˜</p>
</blockquote>
<p>ok,ä½†æ˜¯æ—¶é—´æœ‰é™ï¼Œå¥³å‹å‚¬æˆ‘å»ç¡è§‰ï¼Œåªèƒ½æš‚æ—¶å†™ä¸€ä¸ªpicassoçš„åˆå§‹åŒ–æ“ä½œäº†,ğŸ˜„ã€‚</p>
<pre><code>   /**
 * The global {@link Picasso} instance.
 * &lt;p&gt;
 * This instance is automatically initialized with defaults that are suitable to most
 * implementations.
 * &lt;ul&gt;
 * &lt;li&gt;LRU memory cache of 15% the available application RAM&lt;/li&gt;
 * &lt;li&gt;Disk cache of 2% storage space up to 50MB but no less than 5MB. (Note: this is only
 * available on API 14+ &lt;em&gt;or&lt;/em&gt; if you are using a standalone library that provides a disk
 * cache on all API levels like OkHttp)&lt;/li&gt;
 * &lt;li&gt;Three download threads for disk and network access.&lt;/li&gt;
 * &lt;/ul&gt;
 * &lt;p&gt;
 * If these settings do not meet the requirements of your application you can construct your own
 * with full control over the configuration by using {@link Picasso.Builder} to create a
 * {@link Picasso} instance. You can either use this directly or by setting it as the global
 * instance with {@link #setSingletonInstance}.
 */
public static Picasso with() {
  if (singleton == null) {
    synchronized (Picasso.class) {
      if (singleton == null) {
        if (PicassoProvider.context == null) {
          throw new IllegalStateException(&quot;context == null&quot;);
        }
        singleton = new Builder(PicassoProvider.context).build();
      }
    }
  }
  return singleton;
}
</code></pre><p>å–ï¼Œè¿™å°±æ˜¯picasso çš„åˆå§‹åŒ–ä»£ç ï¼Œè¯·æ³¨æ„ï¼Œä¸‹é¢çš„ä»£ç ä¸é‡è¦ï¼Œå…¶ä¸­çš„æ³¨é‡Šå¾ˆé‡è¦ï¼Œè‹±è¯­å¥½çš„åŒå­¦åº”è¯¥ä¸€çœ¼å°±çœ‹æ‡‚äº†ï¼Œç°åœ¨å–ä¸ªå…³å­ï¼Œæ˜å¤©æœ‰æ—¶é—´è¿›è¡Œæ›´æ–°ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¦‚é¢˜ï¼Œä»Šå¤©æˆ‘è¦åšçš„æ˜¯å¯¹picassoè¿›è¡Œä¸å®Œå…¨è§£æï¼Œåˆ‡å…¥ç‚¹å°±é‚£ä¹ˆå‡ ç‚¹ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;1.å¦‚ä½•åˆå§‹åŒ–&lt;br&gt;2.æ€ä¹ˆåšçš„è”ç½‘è¯·æ±‚&lt;br&gt;3.å¦‚ä½•åšçš„å›¾ç‰‡å‹ç¼©&lt;br&gt;4.å¦‚ä½•åšçš„å†…å­˜ä¸æœ¬åœ°ç¼“å­˜&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ok,ä½†æ˜¯æ—¶é—´
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>picassoä¸­ä¸€äº›å¥½ç©çš„ä¸œè¥¿</title>
    <link href="http://yoursite.com/2017/08/12/picasso%E4%B8%AD%E4%B8%80%E4%BA%9B%E5%A5%BD%E7%8E%A9%E7%9A%84%E4%B8%9C%E8%A5%BF/"/>
    <id>http://yoursite.com/2017/08/12/picassoä¸­ä¸€äº›å¥½ç©çš„ä¸œè¥¿/</id>
    <published>2017-08-11T16:52:30.000Z</published>
    <updated>2017-08-14T16:15:51.000Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™ä¸¤å¤©æƒ³æŸ¥ä¸€æŸ¥picassoçš„å®ç°åŸç†ï¼Œå½“ç„¶æ˜¯ä»picasso æä¾›çš„sampleçœ‹èµ·äº†ï¼Œè¿™ä¸€çœ‹ä¸è¦ç´§ï¼Œå‘ç°äº†ç‚¹å¥½ç©çš„å†™æ³•ï¼Œç°åœ¨è®°å½•ä¸€ä¸‹ï¼š</p>
<p>1.Collectionsçš„ä¸¤ä¸ªç”¨æ³•ï¼Œæ„æ€æ˜¯å°†Data.URLSè¿™ä¸ªæ•°ç»„å…¨éƒ½è£…åˆ°å‰é¢çš„urlsé‡Œé¢å»ï¼Œç„¶åå†è®²urlçš„é¡ºåºæ‰“ä¹±ï¼Œä»è€ŒEnsure we get a different ordering of images on each run.å³ä¿è¯æ¯æ¬¡è¿›æ¥éƒ½æ˜¯ä¸ä¸€æ ·çš„å›¾ç‰‡é¡ºåº</p>
<pre><code>// Ensure we get a different ordering of images on each run.
    Collections.addAll(urls, Data.URLS);
    Collections.shuffle(urls);
</code></pre><p>2.å°†è¿™ä¸ªé›†åˆæ‰©å¤§ä¸‰å€ï¼Œå³è‡ªå·±åˆå°†è‡ªå·±å­˜å…¥äº†ä¸¤ä»½ã€‚<br>  è¿™é‡Œçš„ç¬¬ä¸€ä¸ªåˆå§‹åŒ–é›†åˆçš„æ–¹æ³•æ¯”è¾ƒç‹¬ç‰¹ï¼Œèƒ½å¤Ÿå¿«é€Ÿåˆ›å»ºå¹¶ä¸”å°†è‡ªå·±çš„å†…å®¹å¡«å……ä¸Šã€‚<br>    // Triple up the list.<br>        ArrayList<string> copy = new ArrayList&lt;&gt;(urls);<br>        urls.addAll(copy);<br>        urls.addAll(copy);    </string></p>
<p>3.æ–¹å½¢çš„å›¾ç‰‡ï¼Œè¿™ä¸ªæ¯”è¾ƒç®€å•ï¼Œå°±ä¸å¤šè¯´äº†</p>
<pre><code>    /** An image view which always remains square with respect to its width. */
public final class SquaredImageView extends ImageView {
  public SquaredImageView(Context context) {
    super(context);
  }

  public SquaredImageView(Context context, AttributeSet attrs) {
    super(context, attrs);
  }

  @Override protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
    super.onMeasure(widthMeasureSpec, heightMeasureSpec);
    setMeasuredDimension(getMeasuredWidth(), getMeasuredWidth());
  }
}  
</code></pre><p>4.æ§åˆ¶æ‰‹æŒ‡æ»‘åŠ¨gridviewæ—¶å›¾ç‰‡çš„åŠ è½½ä¸å¦</p>
<pre><code>    public class SampleScrollListener implements AbsListView.OnScrollListener {
  private final Context context;

  public SampleScrollListener(Context context) {
    this.context = context;
  }

  @Override
  public void onScrollStateChanged(AbsListView view, int scrollState) {
    final Picasso picasso = Picasso.with();
    if (scrollState == SCROLL_STATE_IDLE || scrollState == SCROLL_STATE_TOUCH_SCROLL) {
      picasso.resumeTag(context);
    } else {
      picasso.pauseTag(context);
    }
  }
  @Override
  public void onScroll(AbsListView view, int firstVisibleItem, int visibleItemCount,
                       int totalItemCount) {
    // Do nothing.
  }
} 
</code></pre><p>okï¼Œç°åœ¨æˆ‘ä»¬å°±åªåˆ†æå…¶ä¸­ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„ï¼Œæœ‰æ—¶é—´ä¼šå¯¹picasso åšä¸€ä¸ªé’ˆå¯¹æ€§çš„åˆ¨æï¼Œæ¯”å¦‚picassoæ˜¯ç”¨ä»€ä¹ˆè¿›è¡Œç½‘ç»œè¯·æ±‚ï¼Œpicassoæ€ä¹ˆå‹ç¼©çš„å›¾ç‰‡ï¼Œpicassoæœ‰æ²¡æœ‰åšç¼“å­˜å¤„ç†ï¼Œå…·ä½“æ€ä¹ˆåšçš„ï¼Œç¨åä¼šä¸€ä¸€è®°å½•ï¼Œæ•¬è¯·æœŸå¾…ã€‚ </p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿™ä¸¤å¤©æƒ³æŸ¥ä¸€æŸ¥picassoçš„å®ç°åŸç†ï¼Œå½“ç„¶æ˜¯ä»picasso æä¾›çš„sampleçœ‹èµ·äº†ï¼Œè¿™ä¸€çœ‹ä¸è¦ç´§ï¼Œå‘ç°äº†ç‚¹å¥½ç©çš„å†™æ³•ï¼Œç°åœ¨è®°å½•ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;1.Collectionsçš„ä¸¤ä¸ªç”¨æ³•ï¼Œæ„æ€æ˜¯å°†Data.URLSè¿™ä¸ªæ•°ç»„å…¨éƒ½è£…åˆ°å‰é¢çš„urlsé‡Œé¢å»ï¼Œç„¶åå†è®²urlçš„é¡º
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>éšç¬”</title>
    <link href="http://yoursite.com/2017/08/10/%E9%9A%8F%E7%AC%94/"/>
    <id>http://yoursite.com/2017/08/10/éšç¬”/</id>
    <published>2017-08-10T09:28:11.000Z</published>
    <updated>2017-08-10T09:49:52.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨ç†Ÿæ‚‰XXé¡¹ç›®çš„æºç ï¼Œè¿™é‡Œåšä¸‹è®°å½•</p>
<p>1.æ­¤æ–¹æ³•èƒ½å¤Ÿå°†androidç‰ˆæœ¬å¤§äºç­‰äº19ï¼Œä¹Ÿå°±æ˜¯android4.4ç‰ˆæœ¬çš„è¯ï¼Œå°±å¯ä»¥è®©å½“å‰ä½¿ç”¨äº†æ­¤æ–¹æ³•çš„activityçŠ¶æ€æ ä¸ºæ¯›ç»ç’ƒé€æ˜çŠ¶æ€</p>
<pre><code>if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) {
//é€æ˜çŠ¶æ€æ 
getWindow().addFlags(WindowManager.LayoutParams.FLAG_TRANSLUCENT_STATUS);
   }
</code></pre><p>2.æœ‰çš„æ—¶å€™æˆ‘ä»¬éœ€è¦å¯¹æœ¬appè¿›è¡Œ â€œæ–°æ‰‹æŒ‡å—â€å¼•å¯¼ï¼Œå…¶å®è¿™ä¸ªä¸œè¥¿çš„å®ç°æ–¹å¼å¾ˆç®€å•ï¼Œä¸€èˆ¬æˆ‘ä»¬éƒ½é‡‡ç”¨UIç»™æˆ‘ä»¬Pçš„å›¾è¿›è¡Œå±•ç¤ºï¼Œç„¶åæ§åˆ¶éšè—æ˜¾ç¤ºå³å¯ã€‚ä½ çœ‹åˆ°çš„ä»¥ä¸ºæ˜¯é€æ˜çš„å›¾ç‰‡ï¼Œå…¶å®æ˜¯ç¾å·¥åˆ‡å¥½çš„â€œå‡è±¡â€ï¼Œå¼€å‘æœ‰å¾ˆå¤šå¥—è·¯ã€‚ã€‚ã€‚<br>è¿™é‡Œå°±ä¸å±•ç¤ºUI Pçš„å›¾ç‰‡äº†ï¼Œè®¾è®¡å…¬å¸éšç§ã€‚ã€‚ã€‚</p>
<p>3.æäº¤gitå‡ºç°äº†é”™è¯¯ï¼š</p>
<blockquote>
<p>Failed to connect to 127.0.0.1 port 1080: Connection refused</p>
</blockquote>
<p>è§£å†³æ–¹æ³•ï¼šterminalä¸­è¾“å…¥</p>
<blockquote>
<p>open ~/.gitconfig</p>
</blockquote>
<p>ç„¶ååˆ é™¤é‡Œé¢çš„</p>
<blockquote>
<p>[http â€œ<a href="https://github.com" target="_blank" rel="external">https://github.com</a>â€œ]<br>proxy = socks5://127.0.0.1:1080 </p>
</blockquote>
<p>å³å¯æäº¤</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘åœ¨ç†Ÿæ‚‰XXé¡¹ç›®çš„æºç ï¼Œè¿™é‡Œåšä¸‹è®°å½•&lt;/p&gt;
&lt;p&gt;1.æ­¤æ–¹æ³•èƒ½å¤Ÿå°†androidç‰ˆæœ¬å¤§äºç­‰äº19ï¼Œä¹Ÿå°±æ˜¯android4.4ç‰ˆæœ¬çš„è¯ï¼Œå°±å¯ä»¥è®©å½“å‰ä½¿ç”¨äº†æ­¤æ–¹æ³•çš„activityçŠ¶æ€æ ä¸ºæ¯›ç»ç’ƒé€æ˜çŠ¶æ€&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;if (Build.VERSION.SD
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>DiskLruCacheå®Œå…¨è§£æ</title>
    <link href="http://yoursite.com/2017/08/09/disklrucache/"/>
    <id>http://yoursite.com/2017/08/09/disklrucache/</id>
    <published>2017-08-09T04:15:07.000Z</published>
    <updated>2017-08-10T01:25:54.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://oucijhbtq.bkt.clouddn.com/bb.png?imageMogr2/auto-orient/thumbnail/884x/blur/1x0/quality/75|imageslim" alt="BLACKBERRY" title="BLACKBERRY"></p>
<p>é‡æ–°çœ‹äº†ä¸‹éƒ­éœ–çš„disklrucache,ç°åœ¨åœ¨è¿™é‡Œåšä¸‹è®°å½•</p>
<p>disklrucache æ˜¯Jç¥ä¸ºè§£å†³å®é™…å¼€å‘é¡¹ç›®ä¸­çš„æœ¬åœ°ç¼“å­˜é—®é¢˜è€Œè´¡çŒ®çš„ä¸€ä¸ªå°æ¡†æ¶ï¼Œæ•´ä¸ªå°æ¡†æ¶ä»…ä»…æœ‰ä¸‰ä¸ªç±»ï¼š</p>
<blockquote>
<p>DiskLruCache.java<br>StrictLineReader.java<br>Util.java    </p>
</blockquote>
<p>æˆ‘ä»¬åœ¨ä½¿ç”¨çš„æ—¶å€™çš„å¤§è‡´æ­¥éª¤æ˜¯ï¼š</p>
<p>1ã€å…ˆå¾—åˆ°DiskLruCacheè¿™ä¸ªå¯¹è±¡</p>
<p>2ã€æ“ä½œè¿™ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­åŒ…æ‹¬å­˜ï¼Œå–ï¼Œåˆ ç­‰æ“ä½œ</p>
<p>3ã€æ¸…ç†ç¼“å­˜</p>
<p>ä¸‹é¢ä¾æ¬¡ä»‹ç»ä¸€ä¸‹ï¼š</p>
<font color="#f00" size="3">1ã€å…ˆå¾—åˆ°DiskLruCacheè¿™ä¸ªå¯¹è±¡</font><br>(æºè‡ªæºç ï¼‰ï¼š<br><br>     /<em>*
       </em> Opens the cache in {@code directory}, creating a cache if none exists there.<br>          <em>
          </em> @param directory a writable directory<br>         <em> @param valueCount the number of values per cache entry. Must be positive.
          </em> @param maxSize the maximum number of bytes this cache should use to store<br>          <em> @throws IOException if reading or writing the cache directory fails
         </em>/<br>    public static DiskLruCache open(File directory, int appVersion, int valueCount, long maxSize)<br>      throws IOException {<br>    if (maxSize &lt;= 0) {<br>      throw new IllegalArgumentException(â€œmaxSize &lt;= 0â€);<br>    }<br>    if (valueCount &lt;= 0) {<br>      throw new IllegalArgumentException(â€œvalueCount &lt;= 0â€);<br>    }<br><br>    // If a bkp file exists, use it instead.<br>    File backupFile = new File(directory, JOURNAL_FILE_BACKUP);<br>    if (backupFile.exists()) {<br>      File journalFile = new File(directory, JOURNAL_FILE);<br>      // If journal file also exists just delete backup file.<br>      if (journalFile.exists()) {<br>        backupFile.delete();<br>      } else {<br>        renameTo(backupFile, journalFile, false);<br>      }<br>    }<br><br>    // Prefer to pick up where we left off.<br>    DiskLruCache cache = new DiskLruCache(directory, appVersion, valueCount, maxSize);<br>    if (cache.journalFile.exists()) {<br>      try {<br>        cache.readJournal();<br>        cache.processJournal();<br>        return cache;<br>      } catch (IOException journalIsCorrupt) {<br>        System.out<br>            .println(â€œDiskLruCache â€œ<br>                + directory<br>                + â€œ is corrupt: â€œ<br>                + journalIsCorrupt.getMessage()<br>                + â€œ, removingâ€);<br>        cache.delete();<br>      }<br>    }<br><br>    // Create a new empty cache.<br>    directory.mkdirs();<br>    cache = new DiskLruCache(directory, appVersion, valueCount, maxSize);<br>    cache.rebuildJournal();<br>    return cache;<br>      }<br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒDiskLruCacheéœ€è¦é€šè¿‡opençš„æ–¹æ³•æ‹¿åˆ°å®ä¾‹å¯¹è±¡ï¼ˆå› ä¸ºDiskLruCacheæœ¬èº«å·²ç»è¢«å•ä¾‹æ¨¡å¼äº†ï¼‰<br><br>è¿™ä¸ªopenæ–¹æ³•é‡Œé¢å¤§è‡´åšäº†<br><br><font color="#F00">journalæ–‡ä»¶çš„åˆ›å»º</font>

<font color="#F00">journalå¤‡ä»½æ–‡ä»¶çš„åˆ›å»º</font>

<font color="#F00">æ ¹æ®è¾“å…¥æ–‡ä»¶ç›®å½•åˆ›å»ºå‡ºæ–‡ä»¶å¤¹</font>

<font color="#F00">ä¸€äº›å…¨å±€å˜é‡çš„åˆå§‹åŒ–æ“ä½œ</font>

<p>æˆ‘ä»¬åœ¨ç”¨openæ–¹æ³•æ—¶éœ€è¦ä¼ é€’çš„å‚æ•°æ˜¯</p>
<p>1.è¦åˆ›å»ºçš„æ–‡ä»¶ç›®å½•å</p>
<p>2.å½“å‰æˆ‘ä»¬è¿™ä¸ªåº”ç”¨çš„ç‰ˆæœ¬å·</p>
<p>3.è®¾ç½®ä¸€ä¸ªæ–‡ä»¶åå¯¹åº”çš„æ–‡ä»¶æ•°é‡ï¼Œä¸€èˆ¬ä¼ 1å°±å¯ä»¥</p>
<p>4.è®¾ç½®ç¼“å­˜æ–‡ä»¶çš„å¤§å°</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œopençš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬ä¸€èˆ¬è®¾ç½®æˆä¸ºæœ¬æœºçš„ç¼“å­˜ç›®å½•ï¼Œç°åœ¨æˆ‘ä»¬çš„æ‰‹æœºéƒ½å·²ç»å†…ç½®å†…å­˜å¡äº†ï¼Œä¸è¿‡æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥è¿›è¡Œä¸€æ¬¡åˆ¤æ–­ï¼Œä»è€Œæ‹¿åˆ°æ‰‹æœºä¸­çš„cacheç¼“å­˜ç›®å½•</p>
<p>æ‹¿ç¼“å­˜ç›®å½•çš„æ–¹æ³•æ˜¯ï¼šgetExternalCacheDir()æˆ–è€…æ˜¯getCacheDir()</p>
<p>cacheç¼“å­˜ç›®å½•ç»“æ„æ˜¯â€œ<strong>/sdcard/Android/data/\<application package\="">/cache</application></strong>â€<br>å½“ç„¶å¦‚æœæ‰‹æœºæ¯”è¾ƒè€ï¼Œè€Œä¸”æ²¡æœ‰æŒ‚åœ¨sdå¡çš„è¯ï¼Œ<br>åªèƒ½æ‹¿åˆ°è¿™æ ·çš„ç›®å½•äº†â€œ<strong>/data/data/\<application package\="">/cache</application></strong>â€</p>
<hr>
<font color="#f00" size="3">2ã€ä½¿ç”¨DiskLruCacheè¿™ä¸ªå¯¹è±¡è¿›è¡Œæœ¬åœ°ç¼“å­˜æ–‡ä»¶çš„å­˜ã€å–ã€åˆ </font>

<p>æˆ‘ä»¬é€šè¿‡open(ç›®å½•,appç‰ˆæœ¬å·,åŒåæ–‡ä»¶æ•°é‡,ç¼“å­˜æ§ä»¶å¤§å°)æ‹¿åˆ°DiskLruCacheä¹‹åï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹DiskLruCacheçš„ä½¿ç”¨æ–¹æ³•ï¼š</p>
<pre><code>å­˜ï¼šedit +commit
å–ï¼šget
åˆ ï¼šremove
æ¸…ç¼“å­˜ï¼šdelete
</code></pre><p>1âƒ£ï¸ å­˜</p>
<p>ä½¿ç”¨æ–¹æ³•å…¶å®å¾ˆç®€å•ï¼Œå…¶ä¸­éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸€èˆ¬æˆ‘ä»¬åœ¨å­˜æ•°æ®çš„æ—¶å€™ï¼Œå­˜çš„æ•°æ®åç§°å¹¶ä¸æ˜¯æ•°æ®æœ¬æ¥çš„åç§°</p>
<p>æ¯”å¦‚è¯´ç½‘ç»œåŠ è½½çš„å›¾ç‰‡ï¼Œæˆ‘ä»¬ä¸€èˆ¬æ˜¯æŠŠè¿™ä¸ªå›¾ç‰‡çš„ç½‘å€å½“åšåç§°æ ‡è®°ï¼ŒæŠŠå›¾ç‰‡ç½‘å€ç»è¿‡md5åŠ å¯†æ–¹å¼è¿›è¡ŒåŠ å¯†</p>
<p>å¾—åˆ°ä¸€ä¸²16è¿›åˆ¶æ•°ç»„æˆçš„Stringå­—ç¬¦ä¸²å½“åšæ–‡ä»¶çš„åå­—ã€‚</p>
<p>è¿™é‡Œæä¾›ä¸€ä¸ªmd5å·¥å…·ç±»ï¼Œç½‘ä¸Šéšä¾¿ä¸€æœéƒ½èƒ½æœåˆ°</p>
<pre><code>    public String 2Md5(String key) {  
    String cacheKey;  
    try {  
        final MessageDigest mDigest = MessageDigest.getInstance(&quot;MD5&quot;);  
        mDigest.update(key.getBytes());  
        cacheKey = bytesToHexString(mDigest.digest());  
    } catch (NoSuchAlgorithmException e) {  
        cacheKey = String.valueOf(key.hashCode());  
    }  
    return cacheKey;  
}  

private String bytesToHexString(byte[] bytes) {  
    StringBuilder sb = new StringBuilder();  
    for (int i = 0; i &lt; bytes.length; i++) {  
        String hex = Integer.toHexString(0xFF &amp; bytes[i]);  
        if (hex.length() == 1) {  
            sb.append(&apos;0&apos;);  
        }  
        sb.append(hex);  
    }  
    return sb.toString();  
}  
</code></pre><p>æ‰€ä»¥è¯´DiskLruCacheçš„editæ–¹æ³•å°±æ˜¯è¿™ä¹ˆè®¾è®¡çš„ï¼š</p>
<pre><code> public Editor edit(String key) throws IOException {
  return edit(key, ANY_SEQUENCE_NUMBER);
}

private synchronized Editor edit(String key, long expectedSequenceNumber) throws         IOException {
  checkNotClosed();
  validateKey(key);
  Entry entry = lruEntries.get(key);
  if (expectedSequenceNumber != ANY_SEQUENCE_NUMBER &amp;&amp; (entry == null
      || entry.sequenceNumber != expectedSequenceNumber)) {
    return null; // Snapshot is stale.
  }
  if (entry == null) {
    entry = new Entry(key);
    lruEntries.put(key, entry);
  } else if (entry.currentEditor != null) {
    return null; // Another edit is in progress.
  }

  Editor editor = new Editor(entry);
  entry.currentEditor = editor;

  // Flush the journal before creating files to prevent file leaks.
  journalWriter.write(DIRTY + &apos; &apos; + key + &apos;\n&apos;);
  journalWriter.flush();
  return editor;
}
</code></pre><p>editæ–¹æ³•è°ƒç”¨äº†å†…éƒ¨çš„åŒæ­¥æ–¹æ³• edit(key,-1) æ€è·¯æ˜¯å‘ä»¥lruEntriesä¸ºå¯¹è±¡åçš„LinkedHashMapé‡Œé¢å­˜å…¥æ–‡ä»¶åç§°å’ŒEntryï¼Œé‚£ä¹ˆEntryå°±æ˜¯ä»¥åæˆ‘ä»¬å­˜å…¥çš„æµæ–‡ä»¶</p>
<hr>
<p>ç»†å¿ƒçš„åŒå­¦åº”è¯¥å·²ç»æ³¨æ„åˆ°äº†ï¼Œeditæ–¹æ³•æ‰§è¡Œå®Œåï¼Œå°±ä¼šè¿”å›ä¸€ä¸ªEditorå¯¹è±¡ï¼Œå› ä¸ºæˆ‘ä»¬çš„editæ–¹æ³•åªèƒ½ä¼ å…¥åç§°ï¼Œæ‰€ä»¥å¾€DiskLruCacheé‡Œé¢å­˜æ•°æ®çš„é‡ä»»å°±äº¤ç»™äº†Editoräº†</p>
<p>å¾€Editoré‡Œé¢å­˜å…¥æ•°æ®çš„æ–¹æ³•æ˜¯ï¼š</p>
<pre><code>public OutputStream newOutputStream(int index) throws IOException {
  if (index &lt; 0 || index &gt;= valueCount) {
    throw new IllegalArgumentException(&quot;Expected index &quot; + index + &quot; to &quot;
            + &quot;be greater than 0 and less than the maximum value count &quot;
            + &quot;of &quot; + valueCount);
  }
  synchronized (DiskLruCache.this) {
    if (entry.currentEditor != this) {
      throw new IllegalStateException();
    }
    if (!entry.readable) {
      written[index] = true;
    }
    File dirtyFile = entry.getDirtyFile(index);
    FileOutputStream outputStream;
    try {
      outputStream = new FileOutputStream(dirtyFile);
    } catch (FileNotFoundException e) {
      // Attempt to recreate the cache directory.
      directory.mkdirs();
      try {
        outputStream = new FileOutputStream(dirtyFile);
      } catch (FileNotFoundException e2) {
        // We are unable to recover. Silently eat the writes.
        return NULL_OUTPUT_STREAM;
      }
    }
    return new FaultHidingOutputStream(outputStream);
  }
}
</code></pre><p> ä¸»è¦æ€è·¯å¡‘é€ äº†ä¸€ä¸ª â€œdirtyFileâ€çš„è¾“å‡ºæµï¼Œè¿™ä¸ªâ€œdirtyFileâ€æ˜¯ä¸€ä¸ªå‡†å¤‡å¥½çš„â€œç¼“å­˜æ–‡ä»¶â€ï¼Œåç¼€æ˜¯.tmpï¼ˆâ€œä½œè€…æä¾›äº†ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯dirtyFile ä¸€ä¸ªæ˜¯cleanFileï¼ŒdirtyFileä¼šè¢«åæœŸæ¸…ç†æ—¶åŠæ—¶æ¸…ç†æ‰ï¼Œåªæœ‰ç»è¿‡cleanåçš„dirtyFileæ‰èƒ½è½¬åŒ–æˆä¸ºcleanFileâ€ï¼‰<br> æ‹¿åˆ°ä¸Šæ–¹çš„OutputStreamä¹‹åï¼Œæˆ‘ä»¬æŠŠä»ç½‘ç»œä¸‹è½½ä¸‹æ¥çš„æµå†™å…¥å³å¯å­˜å…¥åˆ°dirtyFileä¸­å»äº†ã€‚</p>
 <font color="#f00">æ³¨æ„ï¼šä¸Šæ–¹ä»…ä»…æ˜¯è¿›è¡Œäº†æµçš„å†™å…¥åˆ°äº†dirtyFileï¼Œç„¶åä»¥åæƒ³è¦ç”¨è¿™ä¸ªæ–‡ä»¶ï¼Œéœ€è¦è¿›è¡Œcommit,è¿™æ ·æ‰èƒ½å˜æˆcleanFile,è¿™äº›æ“ä½œåœ¨è°ƒç”¨å®Œflushåï¼Œå°†ä¼šå­˜åˆ°æ—¥å¿—æ–‡ä»¶journalä¸­å»</font>

<p> 2âƒ£ï¸ å–</p>
<p> å–å‡ºæœ¬åœ°ç¼“å­˜çš„å°±æ¯”è¾ƒç®€å•äº†ï¼Œä¸‹é¢æ˜¯æºç ï¼š</p>
<pre><code> public synchronized Snapshot get(String key) throws IOException {
checkNotClosed();
validateKey(key);
Entry entry = lruEntries.get(key);
if (entry == null) {
  return null;
}

if (!entry.readable) {
  return null;
}

// Open all streams eagerly to guarantee that we see a single published
// snapshot. If we opened streams lazily then the streams could come
// from different edits.
InputStream[] ins = new InputStream[valueCount];
try {
  for (int i = 0; i &lt; valueCount; i++) {
    ins[i] = new FileInputStream(entry.getCleanFile(i));
  }
} catch (FileNotFoundException e) {
  // A file must have been deleted manually!
  for (int i = 0; i &lt; valueCount; i++) {
    if (ins[i] != null) {
      Util.closeQuietly(ins[i]);
    } else {
      break;
    }
  }
  return null;
}

redundantOpCount++;
journalWriter.append(READ + &apos; &apos; + key + &apos;\n&apos;);
if (journalRebuildRequired()) {
  executorService.submit(cleanupCallable);
}

return new Snapshot(key, entry.sequenceNumber, ins, entry.lengths);
  }
</code></pre><p>  é‚£ä¹ˆé‡Œé¢çš„æ“ä½œåŸºæœ¬ä¸Šæœ‰è¿™ä¹ˆå‡ ç‚¹</p>
<p>  1.æ£€æŸ¥æœ¬åœ°ç¼“å­˜æ˜¯å¦å…³é—­ï¼Œç¡®ä¿å¤„äºæœªå…³é—­çŠ¶æ€ï¼Œè¿™æ˜¯é€šè¿‡journalWriteræ¥åˆ¤æ–­çš„(<font color="#f00">æ–‡ä»¶çš„å­˜å–åˆ éƒ½è·Ÿæ—¥å¿—æ–‡ä»¶æœ‰å…³ç³»</font>ï¼‰</p>
<p>  2.æ£€éªŒä¼ å…¥å‚æ•°â€œkeyâ€çš„æœ‰æ•ˆæ€§ï¼Œåº”ä¸ºJç¥åœ¨è®¾è®¡çš„æ—¶å€™å¯¹å­˜å…¥çš„æ–‡ä»¶åæœ‰ç‰¹æ®Šçš„è§„å®šï¼Œå¿…é¡»æ˜¯1åˆ°120ä¸ªå­—ç¬¦ä»¥å†…çš„ï¼Œå¹¶ä¸”å–å€¼èŒƒå›´æ˜¯0-9ï¼Œa-Z,åªèƒ½åŒ…æ‹¬ä¸‹åˆ’çº¿å’Œä¸­åˆ’çº¿ï¼Œæ‰€ä»¥è¿™å¯¹æ–‡ä»¶ååšäº†é™å®šã€‚</p>
<p>  3.ä¸‹é¢å°±ç›´æ¥ä»LinkedHashMapä¸­è¯»å–åç§°ä¸ºkeyçš„Entryæ•°æ®äº†(å› ä¸ºæˆ‘ä»¬å­˜çš„æ—¶å€™å°±å­˜åˆ°äº†æ­¤linkedHashMapä¹‹ä¸­)</p>
<p>  4.ç”±äºæ—¥å¿—æ–‡ä»¶å’Œè¯» å– åˆ  æ–‡ä»¶éƒ½æ˜¯ç›¸å…³çš„ï¼Œæ‰€ä»¥åœ¨å–æ–‡ä»¶çš„æ—¶å€™ä¹Ÿè¦å¯¹journalè¿›è¡Œè®°å½•</p>
<p>  5.æ¯”è¾ƒé‡è¦çš„ä¸€æ­¥â€œredundantOpCount++;â€è¿™å¥ä»£ç æ˜¯å¯¹journal ä¸­çš„æ—¥å¿—è®°å½•è¿›è¡Œè®¡æ•°ï¼Œå½“è¾¾åˆ°ä¸€å®šçš„ä¸´ç•Œå€¼çš„æ—¶å€™<br>  journalæ–‡ä»¶å°±ä¼šè¢«é‡æ–°åˆ›å»ºã€‚ä»£ç å¦‚ä¸‹</p>
<pre><code>  /**
 * We only rebuild the journal when it will halve the size of the journal
 * and eliminate at least 2000 ops.
 */
private boolean journalRebuildRequired() {
  final int redundantOpCompactThreshold = 2000;
  return redundantOpCount &gt;= redundantOpCompactThreshold //
      &amp;&amp; redundantOpCount &gt;= lruEntries.size();
}
</code></pre><p>3âƒ£ï¸ åˆ </p>
<p>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦å¯¹ç‰¹å®šçš„æ–‡ä»¶è¿›è¡Œåˆ é™¤ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„splashé¡µé¢å¯èƒ½ä¼šè®¾ç½®æˆå¯ä»¥å˜åŒ–çš„å›¾ç‰‡ï¼Œè¿™ä¸ªæ—¶å€™å°±æ²¡æœ‰å¿…è¦å¯¹è¿™ä¸ªå›¾ç‰‡ç½‘å€è¿›è¡Œç¼“å­˜äº†ï¼Œè€Œæˆ‘ä»¬åˆä¸èƒ½å¯¹æŸä¸ªå›¾ç‰‡åŠ è½½æ¡†æ¶è¿›è¡Œå•ç‹¬çš„ â€œä¸ç¼“å­˜â€œçš„è®¾å®šï¼Œæ‰€ä»¥åªèƒ½è¿›è¡Œè¿™ä¸ªç¼“å­˜æ–‡ä»¶çš„åˆ é™¤äº†ã€‚</p>
<p>åˆ çš„æ“ä½œæ¯”å–è¿˜è¦ç®€å•</p>
<pre><code>/**
  * Drops the entry for {@code key} if it exists and can be removed. Entries
  * actively being edited cannot be removed.
  *
  * @return true if an entry was removed.
  */
 public synchronized boolean remove(String key) throws IOException {
   checkNotClosed();
   validateKey(key);
   Entry entry = lruEntries.get(key);
   if (entry == null || entry.currentEditor != null) {
     return false;
   }

   for (int i = 0; i &lt; valueCount; i++) {
     File file = entry.getCleanFile(i);
     if (file.exists() &amp;&amp; !file.delete()) {
       throw new IOException(&quot;failed to delete &quot; + file);
     }
     size -= entry.lengths[i];
     entry.lengths[i] = 0;
   }

   redundantOpCount++;
   journalWriter.append(REMOVE + &apos; &apos; + key + &apos;\n&apos;);
   lruEntries.remove(key);

   if (journalRebuildRequired()) {
     executorService.submit(cleanupCallable);
   }

   return true;
 }
</code></pre><p> é™¤äº†è·Ÿå–æœ‰å‡ ä¸ªç›¸ä¼¼ç‚¹ä¹‹å¤–ï¼Œå…¶ä»–çš„å°±æ˜¯å¯¹LinkedHashMapè¿›è¡Œäº†removeçš„æ“ä½œï¼Œå¹¶ä¸”å¯¹æ—¥å¿—æ–‡ä»¶è¿›è¡Œäº†æ–°çš„æ·»åŠ </p>
<p> 4âƒ£ï¸ å…¶ä»–çš„ä¸€äº›apiçš„ä½¿ç”¨</p>
<ol>
<li>size()<br>è¿™ä¸ªæ–¹æ³•ä¼šè¿”å›å½“å‰ç¼“å­˜è·¯å¾„ä¸‹æ‰€æœ‰ç¼“å­˜æ•°æ®çš„æ€»å­—èŠ‚æ•°ï¼Œä»¥byteä¸ºå•ä½ï¼Œå¦‚æœåº”ç”¨ç¨‹åºä¸­éœ€è¦åœ¨ç•Œé¢ä¸Šæ˜¾ç¤ºå½“å‰ç¼“å­˜æ•°æ®çš„æ€»å¤§å°ï¼Œå°±å¯ä»¥é€šè¿‡è°ƒç”¨è¿™ä¸ªæ–¹æ³•è®¡ç®—å‡ºæ¥ã€‚</li>
</ol>
<p>Jç¥çš„DiskLruCacheä¸­å­˜åœ¨ç€sizeçš„longç±»å‹çš„å˜é‡ï¼Œå˜é‡åœ¨linkedhashmapæ“ä½œçš„è¿‡ç¨‹ä¸­ä¹Ÿåœ¨ä¸åœçš„åŠ  å‡æ§ä»¶å¤§å°ï¼Œæ‰€ä»¥å½“ç”¨æˆ·è°ƒç”¨çš„æ—¶å€™ï¼Œåªéœ€è¦æŠŠè¿™ä¸ªå˜é‡è¿”å›ç»™ç”¨æˆ·å³å¯ï¼šï¼ˆ<font color="#f00">æ³¨æ„:æˆ‘ä»¬åœ¨åˆå§‹åŒ–çš„æ—¶å€™å·²ç»è®¾å®šäº†DiskLruCacheçš„å¤§å°ï¼Œæ‰€ä»¥Jç¥åœ¨editeræäº¤å…¨éƒ¨çš„æ—¶å€™å¯¹sizeå’Œç¼“å­˜å¤§å°åšäº†æ¯”è¾ƒï¼Œå¦‚æœsizeè¾ƒå¤§ï¼Œé‚£ä¹ˆå°±ä¼šå¯¹Journalæ—¥å¿—æ–‡ä»¶è¿›è¡Œé‡ç½®ï¼Œå¯¹ç¼“å­˜æ–‡ä»¶å³LinkedHashMapè¿›è¡Œé‡Šæ”¾ï¼ˆé‡Šæ”¾è§„åˆ™æ˜¯ä¸‹æ–¹ç¬¬äºŒå—ä»£ç ï¼‰</font>ï¼‰</p>
<pre><code>/**
   * Returns the number of bytes currently being used to store the values in
   * this cache. This may be greater than the max size if a background
   * deletion is pending.
   */
  public synchronized long size() {
    return size;
  }
</code></pre><p>â€“<br>    private void trimToSize() throws IOException {<br>    while (size &gt; maxSize) {<br>      Map.Entry<string, entry=""> toEvict = lruEntries.entrySet().iterator().next();<br>      remove(toEvict.getKey());<br>    }<br>      }<br>  é‡Šæ”¾è§„åˆ™æˆ‘ä»¬å¯ä»¥çœ‹æ‡‚ï¼šå³é‡Šæ”¾äº†æœ€å…ˆå­˜å…¥çš„é‚£ä¸ªæ–‡ä»¶ï¼Œæ¯æ¬¡å½“ç¼“å­˜å†…å­˜ç©ºé—´å¤§äºè®¾å®šçš„ç©ºé—´æ—¶ï¼Œå°±ä¼šé‡Šæ”¾æœ€å…ˆå­˜å…¥çš„é‚£ä¸ªæ–‡ä»¶ã€‚</string,></p>
<p>2.flush()<br>è¿™ä¸ªæ–¹æ³•ç”¨äºå°†å†…å­˜ä¸­çš„æ“ä½œè®°å½•åŒæ­¥åˆ°æ—¥å¿—æ–‡ä»¶ï¼ˆä¹Ÿå°±æ˜¯journalæ–‡ä»¶ï¼‰å½“ä¸­ã€‚è¿™ä¸ªæ–¹æ³•éå¸¸é‡è¦ï¼Œå› ä¸ºDiskLruCacheèƒ½å¤Ÿæ­£å¸¸å·¥ä½œçš„å‰æå°±æ˜¯è¦ä¾èµ–äºjournalæ–‡ä»¶ä¸­çš„å†…å®¹ã€‚å…¶å®æ­¤æ–¹æ³•å¹¶ä¸æ˜¯æ¯æ¬¡å†™å…¥ç¼“å­˜éƒ½è¦è°ƒç”¨ä¸€æ¬¡flush()æ–¹æ³•çš„ï¼Œé¢‘ç¹åœ°è°ƒç”¨å¹¶ä¸ä¼šå¸¦æ¥ä»»ä½•å¥½å¤„ï¼Œåªä¼šé¢å¤–å¢åŠ åŒæ­¥journalæ–‡ä»¶çš„æ—¶é—´ã€‚æ¯”è¾ƒæ ‡å‡†çš„åšæ³•å°±æ˜¯åœ¨Activityçš„onPause()æ–¹æ³•ä¸­å»è°ƒç”¨ä¸€æ¬¡flush()æ–¹æ³•å°±å¯ä»¥äº†ã€‚</p>
<pre><code>/** Force buffered operations to the filesystem. */
  public synchronized void flush() throws IOException {
    checkNotClosed();
    trimToSize();
    journalWriter.flush();
  }
</code></pre><p>3.close()<br>è¿™ä¸ªæ–¹æ³•ç”¨äºå°†DiskLruCacheå…³é—­æ‰ï¼Œæ˜¯å’Œopen()æ–¹æ³•å¯¹åº”çš„ä¸€ä¸ªæ–¹æ³•ã€‚å…³é—­æ‰äº†ä¹‹åå°±ä¸èƒ½å†è°ƒç”¨DiskLruCacheä¸­ä»»ä½•æ“ä½œç¼“å­˜æ•°æ®çš„æ–¹æ³•ï¼Œé€šå¸¸åªåº”è¯¥åœ¨Activityçš„onDestroy()æ–¹æ³•ä¸­å»è°ƒç”¨close()æ–¹æ³•ã€‚</p>
<font color="red">è¿™ä¸ªæ—¶å€™ç”¨æˆ·æ—¢ä¸èƒ½å­˜ä¹Ÿä¸èƒ½å–ï¼Œä½†æ˜¯æ–‡ä»¶è¿˜å­˜åœ¨æœ¬åœ°</font>

<pre><code>/** Closes this cache. Stored values will remain on the filesystem. */
 public synchronized void close() throws IOException {
   if (journalWriter == null) {
     return; // Already closed.
   }
   for (Entry entry : new ArrayList&lt;Entry&gt;(lruEntries.values())) {
     if (entry.currentEditor != null) {
       entry.currentEditor.abort();
     }
   }
   trimToSize();
   journalWriter.close();
   journalWriter = null;
 }
</code></pre><p>4.delete()<br>è¿™ä¸ªæ–¹æ³•ç”¨äºå°†æ‰€æœ‰çš„ç¼“å­˜æ•°æ®å…¨éƒ¨åˆ é™¤ï¼Œæ¯”å¦‚è¯´è½¯ä»¶ä¸­çš„é‚£ä¸ªæ‰‹åŠ¨æ¸…ç†ç¼“å­˜åŠŸèƒ½ï¼Œå…¶å®åªéœ€è¦è°ƒç”¨ä¸€ä¸‹DiskLruCacheçš„delete()æ–¹æ³•å°±å¯ä»¥å®ç°äº†ã€‚</p>
<pre><code> /**
   * Closes the cache and deletes all of its stored values. This will delete
   * all files in the cache directory including files that weren&apos;t created by
   * the cache.
   */
  public void delete() throws IOException {
    close();
    Util.deleteContents(directory);
  }

-------------------------------------------------------------------------------

      /**
   * Deletes the contents of {@code dir}. Throws an IOException if any file
   * could not be deleted, or if {@code dir} is not a readable directory.
   */
  static void deleteContents(File dir) throws IOException {
    File[] files = dir.listFiles();
    if (files == null) {
      throw new IOException(&quot;not a readable directory: &quot; + dir);
    }
    for (File file : files) {
      if (file.isDirectory()) {
        deleteContents(file);
      }
      if (!file.delete()) {
        throw new IOException(&quot;failed to delete file: &quot; + file);
      }
    }
  }
</code></pre><p>Jç¥çš„ä»£ç å¤§è‡´ä¸Šå°±è¿™æ ·ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ­¤ç±»æ˜¯å®ç°è‡ªCloseableè¿™ä¸ªæ¥å£çš„ï¼Œè¿™ä¸ªæ¥å£çš„å®é™…ç”¨å¤„ä¸å¤§ï¼Œä½†æ˜¯å´å¼ºè°ƒäº†æœ¬ç±»æ˜¯ä¸€ä¸ªå¯ä»¥å…³é—­çš„æ•°æ®æºï¼Œè°ƒç”¨è¿™ä¸ªæ¥å£çš„å®ç°æ–¹æ³•ç”¨äºé‡Šæ”¾è¿™ä¸ªç±»ä¸­ä¿å­˜çš„æ•°æ®æºã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://oucijhbtq.bkt.clouddn.com/bb.png?imageMogr2/auto-orient/thumbnail/884x/blur/1x0/quality/75|imageslim&quot; alt=&quot;BLACKBERRY&quot; t
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>â€œä»£ç†â€</title>
    <link href="http://yoursite.com/2017/08/08/%E4%BB%A3%E7%90%86/"/>
    <id>http://yoursite.com/2017/08/08/ä»£ç†/</id>
    <published>2017-08-08T03:38:56.000Z</published>
    <updated>2017-08-09T04:13:40.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘æœ‰å‡†å¤‡é¢è¯•çš„å°ä¼™ä¼´é—®æˆ‘JAVAä¸­çš„ä»£ç†æ˜¯ä»€ä¹ˆ?</p>
<p>è¢«è¿™ä¹ˆçªç„¶è¢«è¿™ä¹ˆä¸€é—®ï¼Œæ„Ÿè§‰æœ‰ç‚¹æ‡µé€¼å•Šï¼Œäºæ˜¯èµ¶ç´§å¯¹è¿™ç‚¹çŸ¥è¯†åšä¸ªå¤ä¹ ï¼Œåœ¨è¿™åšä¸‹è®°å½•ã€‚    </p>
<p>â€œä»£ç†â€è¿™ä¸ªåè¯æˆ‘ä»¬éƒ½å¾ˆç†Ÿæ‚‰ï¼Œæœ€å¸¸è§çš„å°±æ˜¯â€œç«è½¦ç¥¨ä»£å”®ç‚¹â€ã€â€œxxxåŒ–å¦†å“ä»£ç†â€ç­‰ç­‰ï¼Œé‚£ä¹ˆä»£ç†çš„æ„æ€å°±æ˜¯ï¼šæˆ‘ä»¬å¯ä»¥ä¸ç”¨çœŸæ­£çš„â€œ<strong>ä¸»ä½“</strong>â€ï¼Œå°±èƒ½å¤Ÿä½¿ç”¨åˆ°â€œ<strong>ä¸»ä½“</strong>â€é‡Œé¢çš„åŠŸèƒ½ï¼Œè®¿é—®åˆ°â€œ<strong>ä¸»ä½“</strong>â€é‡Œé¢çš„æŸä¸ªå±æ€§ã€‚</p>
<p>é‚£ä¹ˆæ€»ç»“ä¸€å¥è¯ï¼šâ€œ<em>ä»£ç†æ˜¯ä¸ºä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ä¸ªä»£ç†è€…ï¼Œåˆ«äººé€šè¿‡è¿™ä¸ªä»£ç†è€…èƒ½å¤Ÿå®Œæˆå¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚</em>â€</p>
<p>Javaä¸­æœ‰ä¸¤ä¸ªä»£ç†æ–¹å¼ï¼Œå³é™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†ï¼Œä½†æ˜¯å®é™…ä¸Šæˆ‘ä»¬åœ¨åšandroidå¼€å‘çš„æ—¶å€™å¹¶æ²¡æœ‰åˆ»æ„çš„å»åœ¨æ„åˆ°åº•ä½¿ç”¨äº†å“ªç§ä»£ç†æ–¹å¼ã€‚æ¯”å¦‚æˆ‘ä»¬åœ¨ç”¨å·¥å‚æ¨¡å¼çš„æ—¶å€™å°±æ˜¯åœ¨ä½¿ç”¨äº†ä¸€ä¸ªç®€å•çš„é™æ€ä»£ç†ã€‚</p>
<p>okï¼Œæˆ‘ä»¬ç°åœ¨è”æƒ³ä¸€ä¸‹ActivityManagerçš„å·¥ä½œä»»åŠ¡ã€‚</p>
<blockquote>
<p>ActivityManager.AppTask<br>  ActivityManager.MemoryInfo<br>  ActivityManager.ProcessErrorStateInfo<br>ActivityManager.RecentTaskInfo<br>ActivityManager.RunningAppProcessInfo<br>ActivityManager.RunningServiceInfo<br>ActivityManager.RunningTaskInfo<br>ActivityManager.TaskDescription</p>
</blockquote>
<p>ä½†æ˜¯è¿™äº›å·¥ä½œä»»åŠ¡å¹¶ä¸æ˜¯ç”±ActvityManageræœ¬èº«å®Œæˆçš„ï¼Œæˆ‘ä»¬ç»†çœ‹æºç çš„è¯ï¼Œä¼šå‘ç°çœŸæ­£å¤„ç†è¿™äº›ä»»åŠ¡çš„â€œ<strong>è§’è‰²</strong>â€æ˜¯        </p>
<font color="#A52A2A" size="4">ActivityManagerNative.getDefault()</font>

<p>ç„¶åå°±ä¼šæ‰¾åˆ°ActivityManagerProxy<br>å†å¾€ä¸‹çœ‹çš„è¯å°±èƒ½å¤Ÿçœ‹åˆ°AMSäº†ï¼Œé‚£ä¹ˆä»–ä»¬ä¹‹é—´çš„å…³ç³»å¤§è‡´æ˜¯è¿™æ ·çš„</p>
<blockquote>
<p>ActivityManagerProxyä»£ç†ç±»æ˜¯ActivityManagerNativeçš„å†…éƒ¨ç±»ï¼›<br>ActivityManagerNativeæ˜¯ä¸ªæŠ½è±¡ç±»ï¼ŒçœŸæ­£å‘æŒ¥ä½œç”¨çš„æ˜¯å®ƒçš„å­ç±»ActivityManagerServiceï¼ˆç³»ç»ŸServiceç»„ä»¶)</p>
</blockquote>
<p>é‚£ä¹ˆå®é™…ä¸ŠActivityManagerçš„æ“ä½œæµç¨‹æ˜¯ï¼Œé€šè¿‡ActivityManagerå»æ‹¿åˆ°ActivityManagerNativeä¸­çš„ä¸€ä¸ªä»£ç†ç±»ï¼Œå°±æ˜¯ActivityManagerProxy,ç„¶åè¿™ä¸ªä»£ç†ç±»å°±ä¼šå¯ä»¥é€šè¿‡è¿›ç¨‹é—´é€šä¿¡æ‹¿åˆ°ActivityManagerServiceï¼Œç„¶åå†å»åšçœŸæ­£çš„ä»»åŠ¡ã€‚</p>
<p>okï¼Œlet me show you the code:(ç®€åŒ–åçš„ä¼ªä»£ç ï¼Œè¿™æ˜¯ä»£ç è¿˜å¥—äº†å‡ å±‚ï¼‰</p>
<pre><code>ActivityManager:

public class ActivityManager{
  doProcessThings(){
  ActivityManagerNative.getDefault().doProcessThings();
    }    
}
</code></pre><p>ä¸Šé¢çš„ä»£ç æ˜¯æˆ‘ä»¬ç®€å•æ¨¡ä»¿ActivityManagerServiceè¿›è¡Œå¤„ç†ï¼Œå› ä¸ºAMSåœ¨å¤„ç†æŸäº›é€»è¾‘çš„æ—¶å€™ï¼Œå®ƒæ˜¯æ”¾åˆ°Cè¯­è¨€ä¸­å»å¤„ç†çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‹¿ActivityManagerServiceçš„æ—¶å€™å¹¶ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ˜¯é€šè¿‡ä¸€ä¸ªAMSçš„ä»£ç†å»æ“ä½œçš„ã€‚</p>
<p>okï¼Œä»¥ä¸Šæ˜¯å¯¹ä»£ç†çš„ä¸€å°ç‚¹æ€»ç»“ï¼Œå¦‚æœæœ‰æ—¶é—´çš„è¯ï¼Œæˆ‘ä¼šå†ç»†è‡´çš„è®°å½•ä¸€ä¸‹çš„ã€‚</p>
<p>have a good time~~~</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘æœ‰å‡†å¤‡é¢è¯•çš„å°ä¼™ä¼´é—®æˆ‘JAVAä¸­çš„ä»£ç†æ˜¯ä»€ä¹ˆ?&lt;/p&gt;
&lt;p&gt;è¢«è¿™ä¹ˆçªç„¶è¢«è¿™ä¹ˆä¸€é—®ï¼Œæ„Ÿè§‰æœ‰ç‚¹æ‡µé€¼å•Šï¼Œäºæ˜¯èµ¶ç´§å¯¹è¿™ç‚¹çŸ¥è¯†åšä¸ªå¤ä¹ ï¼Œåœ¨è¿™åšä¸‹è®°å½•ã€‚    &lt;/p&gt;
&lt;p&gt;â€œä»£ç†â€è¿™ä¸ªåè¯æˆ‘ä»¬éƒ½å¾ˆç†Ÿæ‚‰ï¼Œæœ€å¸¸è§çš„å°±æ˜¯â€œç«è½¦ç¥¨ä»£å”®ç‚¹â€ã€â€œxxxåŒ–å¦†å“ä»£ç†â€ç­‰ç­‰ï¼Œé‚£ä¹ˆä»£ç†çš„æ„æ€å°±æ˜¯
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>aboutme</title>
    <link href="http://yoursite.com/2017/08/06/aboutme/"/>
    <id>http://yoursite.com/2017/08/06/aboutme/</id>
    <published>2017-08-06T05:02:47.000Z</published>
    <updated>2017-08-06T05:08:43.000Z</updated>
    
    <content type="html"><![CDATA[<p>photos:</p>
<ul>
<li><a href="http://bruce.u.qiniudn.com/2013/11/27/reading/photos-0.jpg" target="_blank" rel="external">http://bruce.u.qiniudn.com/2013/11/27/reading/photos-0.jpg</a></li>
<li><a href="http://bruce.u.qiniudn.com/2013/11/27/reading/photos-1.jpg" target="_blank" rel="external">http://bruce.u.qiniudn.com/2013/11/27/reading/photos-1.jpg</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;photos:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://bruce.u.qiniudn.com/2013/11/27/reading/photos-0.jpg&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://bruce.u.q
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://yoursite.com/2017/08/06/hello-world/"/>
    <id>http://yoursite.com/2017/08/06/hello-world/</id>
    <published>2017-08-05T16:13:25.000Z</published>
    <updated>2017-08-05T16:13:25.000Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.
    
    </summary>
    
    
  </entry>
  
</feed>
